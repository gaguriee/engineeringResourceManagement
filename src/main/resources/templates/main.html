<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.8.0/flowbite.min.css"  rel="stylesheet" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <link href='//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSansNeo.css' rel='stylesheet' type='text/css'>
    <link rel="icon" type="image/ico" th:href="@{../static/favicon.ico}">

    <style>
        * { font-family: 'Spoqa Han Sans Neo', 'sans-serif'; }
        /* PC에서의 스타일 */

        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* PC에서는 한 줄에 2개의 열 */
            gap: 10px; /* 아이템 사이의 간격 */
        }

        .radar-chart {
            padding: 24px;
            padding-left: 164px;
            padding-right: 164px;

        }

        /* 모바일 화면에서는 한 줄에 1개의 열로 변경 */
        @media (max-width: 600px) {
            .grid-container {
                grid-template-columns: 1fr;
            }

            .radar-chart {
                padding-left: 0px;
                padding-right: 0px;
            }
        }
    </style>

</head>

<body>
<div th:replace="header :: header"></div>

<section class="bg-white dark:bg-gray-900" >

    <div>

<!--        <iframe src="https://err2.somansa.com/superset/dashboard/1/?standalone=2&slice_id=4" width="100%" height="900" ></iframe>-->
        <iframe src="https://erm2.somansa.com/superset/dashboard/1/?standalone=2&slice_id=4" width="100%" height="900" ></iframe>

    </div>

    <div class="grid-container"   style="background-color: #F7F7F7; padding: 32px; width: 100%">
        <div class="radar-chart" style="width: 100%; background-color: white; display: flex; justify-content: center; align-items: center; ">
            <canvas id="overallRadarChart"></canvas>
        </div>
        <div class="radar-chart" style="width: 100%; background-color: white; display: flex; justify-content: center; align-items: center; ">
            <canvas id="teamRadarChart"></canvas>
        </div>
    </div>

</section>

<div th:replace="footer :: footer"></div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.8.0/flowbite.min.js"></script>
<script th:inline="javascript">
    var stateNames = /*[[${stateNames}]]*/ ;
    var overallSupportTypeHourSums = /*[[${overallSupportTypeHourSums}]]*/ ;
    var teamDataMap = /*[[${teamDataMap}]]*/ ;

    var overallCtx = document.getElementById('overallRadarChart').getContext('2d');
    var teamCtx = document.getElementById('teamRadarChart').getContext('2d');

    // 전체 데이터셋 추가
    var overallDataset = [{
        label: "기술N본부",
        data: overallSupportTypeHourSums,
        backgroundColor: 'rgba(255, 99, 132, 0.2)',
        borderColor: 'rgba(255, 99, 132, 1)',
        borderWidth: 2
    }];

    // 팀별 데이터셋 추가
    // 미리 정의된 팀 색상 배열
    var teamColors = [
        'rgb(255, 99, 132)',  // 붉은색
        'rgb(75, 192, 192)',  // 청록색
        'rgb(54, 162, 235)',  // 파란색
        'rgb(255, 159, 64)',  // 주황색
        'rgb(153, 102, 255)', // 보라색
        'rgb(220, 20, 60)',   // 크림슨
        'rgb(255, 205, 86)',  // 노란색
        'rgb(0, 128, 0)'      // 녹색
    ];

    var teamDatasets = [];
    var colorIndex = 0;

    for (var teamName in teamDataMap) {
        var color = teamColors[colorIndex % teamColors.length]; // 색상을 반복해서 할당
        var transparentColor = color.replace("rgb", "rgba").replace(")", ", 0.5)"); // 투명도 추가
        colorIndex++;

        teamDatasets.push({
            label: teamName,
            data: teamDataMap[teamName],
            backgroundColor: transparentColor, // 투명도 추가된 색상
            borderColor: color,
            borderWidth: 2
        });
    }

    // Radar Chart 생성
    var overallRadarChart = new Chart(overallCtx, {
        type: 'radar',
        data: {
            labels: stateNames,
            datasets: overallDataset
        },
        options: {
            scales: {
                r: {
                    pointLabels: {
                        font: {
                            size: 14 // 글꼴 크기 설정
                        }
                    }
                }
            },
            plugins: {
                title: {
                    display: true,
                    text: "기술본부 업무 집중도 분석",
                    font: {
                        size: 18 // 제목 글꼴 크기 설정
                    }
                },
                legend: {
                    display: true,
                    labels: {
                        font: {
                            size: 12 // 레전드 글꼴 크기 설정
                        }
                    }
                }
            }
        }
    });

    overallCtx.canvas.style.width = "100%";

    var teamRadarChart = new Chart(teamCtx, {
        type: 'radar',
        data: {
            labels: stateNames,
            datasets: teamDatasets
        },
        options: {
            r: {
                angleLines: {
                    lineWidth: 2, // 폭 간격 조절을 위한 선 두께 설정
                },
                pointLabels: {
                    font: {
                        size: 14 // 글꼴 크기 설정
                    }
                }
            },
            plugins: {
                title: {
                    display: true,
                    text: "팀별 업무 집중도 분석",
                    font: {
                        size: 18 // 제목 글꼴 크기 설정
                    }
                },
                legend: {
                    display: true,
                    labels: {
                        font: {
                            size: 12 // 레전드 글꼴 크기 설정
                        }
                    }
                }
            }
        }
    });

    teamRadarChart.canvas.style.width = "100%";

</script>


</body>
</html>